---
title:  "[Android] 폐쇠망에서 gradle 빌드하기"
excerpt: "gradle build"

toc : true
toc_sticky : true

categories:
  - Error
tags: 
  - Android Studio
  - gradle build
---

<br/><br/>


프로젝트를 진행하다보면 은행권이나 국가사업 등 제한된 폐쇠망에서 개발을 해야 하는 상황이 생길 수 있다.
외부 인터넷이 제한된 환경에서는 gradle에서 참조된 정보를 받아오지 못하기 때문에 정상적으로 빌드가 되지 않는데, 이런 환경에서 gradle 빌드를 하는 방법을 알아보자.

<br/>


## 1. 외부망이 되는 환경에서 빌드하기

폐쇠망에서 빌드를 하기 위해서는 인터넷 사용이 가능한 PC가 필요하다. 외부망이 뚫려 있는 PC에서 프로젝트를 생성 후 gradle build를 실행한다.

정상적으로 빌드가 완료되면 Window 기준으로 C:\Users\{PC Name} 경로에 .gralde 폴더가 생성이 된다. 해당 폴더를 열어보면 caches 폴더가 있는데 이 폴더에 build.gradle에 설정된 gradle 버전과 동일한 버전의 이름으로 폴더가 생성이 되었다면 .gradle 폴더를 프로젝트 폴더와 함께 폐쇠망의 PC로 가져간다.

프로젝트 폴더를 함께 가져가는 이유는 동일한 환경에서 빌드를 진행해야 하므로 같은 프로젝트를 가져가서 빌드하는게 편하기 때문이다.

또한 동일한 환경을 맞춰주기 위해 빌드한 환경의 JDK 버전과 SDK 버전을 맞춰줘야 하기 때문에 JDK, SDK 역시 폐쇠망 PC로 옮겨가도록 한다.

<br/>

## 2. 폐쇠망 PC로 옮겨갈 준비물

위에서 한번 설명 했지만, 전체적으로 옮겨가야할 준비물을 정리해보면 다음과 같다.

1. 외부망에서 빌드를 1회 이상 완료한 프로젝트
2. .caches 폴더에 gradle 버전이 생성된 .gradle 폴더
3. 빌드시 설정한 JDK, SDK, Build Tool
4. 안드로이드 스튜디오 설치파일

설치파일의 경우 폐쇠망 환경일 경우 exe 파일 실행권한이 없는 경우도 있을 수 있으니 zip 파일을 가져가는 것을 추천한다.

<br/>

## 3. 폐쇠망 PC에서 세팅하기

준비한 파일들을 다 옮겨오고 폐쇠망 PC에서도 개발환경을 잡아준다. JDK 설치 후 환경변수를 잡고, 안드로이드 스튜디오 설치 후 SDK 설치 경로를 잡아준다. 또한 외부망 PC와 마찬가지로 같은 경로에 .gradle 폴더를 가져온 폴더로 덮어 씌운다.

환경을 잡았으면 스튜디오에서 offline mode를 실행해야 하는데 스튜디오 우측에 gradle 라인을 열면 offline mode 버튼이 있는데 이 버튼을 눌러서 offline mode를 활성화 시킨다.

이 상태에서 build를 진행하면 로컬에 받아놓은 gradle 정보를 통해 빌드가 진행되고 성공적으로 디바이스에 앱이 설치가 되는 것을 확인할 수 있다.